[TOC]

## 表格识别新进展

之前实现了识别表格外围最大轮廓，如下

![](/home/tsq/Documents/丁老师项目组/8.5/表格.png)

现在把识别出的**表格内部**再**细分识别**，把它转换为**excel形式**

## 步骤

### 1.找出交点

老方法(图片灰化,腐蚀,识别横线,识别竖线)：

![](/home/tsq/Documents/丁老师项目组/8.5/识别出表格内部横线竖线交点.png)

### 2.获得各个交点的坐标

![](/home/tsq/Documents/丁老师项目组/8.5/识别出交点的坐标.png)

### 3.按坐标填入excel

按照最长列和最长行的坐标打点

- 只放图片进excel(同一行，占1个单元格)：![](/home/tsq/Documents/丁老师项目组/8.5/exc0.png)

- 只放**识别后的文字**进excel(同一行，占1个单元格)：

  ![](/home/tsq/Documents/丁老师项目组/8.5/exc1.png)

- 放图片和**识别后的文字**(同一行，占2个单元格)进excel：![](/home/tsq/Documents/丁老师项目组/8.5/exc.png)



## 考虑的问题

- 问题1：由于之前的腐蚀操作，每个**空点其实是3、4个像素构成的**，要"聚类"，把这些空点用他们**中心位置的一个像素表示**

  放大图片一看，空白点其实很大，占了3、4个像素,如下:

  ![](/home/tsq/Documents/丁老师项目组/8.5/空白点.png)

- 问题2：手写的会触碰到边缘，导致有孤立的像素点

  如下图，图片中最下一行的**中间位置**出现的**孤立点**就是: 人类写字的时候**笔迹与表格边缘触碰**导致的

  ![](/home/tsq/Documents/丁老师项目组/8.5/孤立.png)

- 问题3：科大讯飞的接口对于小图片的识别效果不佳

## 解决方式

- 问题1："聚类"
- 问题2：过滤
  - 得到最长行和最长列
  - 遍历行row，列col，找`col.loaction`是否在聚类范围内，其所在的行再找与`row.loation`同范围，就找到了定下来的点
  - 不过还是会有一些噪声`QAQ`

- 问题3：待解决